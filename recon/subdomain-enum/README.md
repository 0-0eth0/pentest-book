# Subdomain Enum

```text
# Best tools overall
./sub.sh -a example.com
./chomp-scan.sh -u example.com

# Other common tools
assetfinder example.com
subfinder -d  example.com  -recursive -silent -t 200 -v -o  example.com.subs
knockpy domain.com
amass enum --passive -d example.com -o example.com.subs 
Amass enum  -src -ip -brute -min-for-recursive 2 -d example.com -o example.com.subs
python3 domained.py -d example.com --quick

# Subdomains from Wayback Machine
gau -subs example.com | cut -d / -f 3 | sort -u

# Check alive hosts httpx
https://github.com/projectdiscovery/httpx
httpx -l hosts.txt 
cat hosts.txt | httpx -title -status-code -content-length -web-server

# AltDNS - Subdomains of subdomains XD
altdns -i subdomains.txt -o data_output -w words.txt -r -s results_output.txt

# Onliner to find (sub)domains related to a kword on pastebin through google
# https://github.com/gwen001/pentest-tools/blob/master/google-search.py
google-search.py -t "site:http://pastebin.com kword" -b -d -s 0 -e 5 | sed "s/\.com\//\.com\/raw\//" | xargs curl -s | egrep -ho "[a-zA-Z0-9_\.\-]+kword[a-zA-Z0-9_\.\-]+" | sort -fu

# Dnsrecon
# https://github.com/darkoperator/dnsrecon
python3 dnsrecon.py -d example.com -D subdomains-top1mil-5000.txt -t brt

# Aquatone - Validate subdomains (take screenshots and generate report)
cat hosts.txt | aquatone

# Subdomain bruteforcing
sudo python3 subbrute.py example.com > subbrute_results.txt && massdns -r /MASSDNSPATH/lists/resolvers.txt -t A subbrute_results.txt -o S -w massdns_output.txt
gobuster -m dns -u domain.com -t 100 -w /path/dictionary.txt
amass enum -brute -d example.com -src
# List for subdomain brute https://github.com/assetnote/commonspeak2

# Wildcard subdomain
dig a *.domain.com = dig a asdasdasd132123123213.domain.com -> this is a wildcard subdomain

# Navigate throug target main website with Burp:
    - Without passive scanner
    - Set forms auto submit
    - Scope in advanced, any protocol and one keyword ("tesla")
    - Last step, select all sitemap, Engagement Tools -> Analyze target
    
# Subdomain enumeration from GitHub
https://github.com/gwen001/github-search
python3 github-subdomains.py -t "GITHUB-TOKEN" -d example.com

# Good subdomain finder script
#!/bin/bash
# $1 => example.domainamass 
enum --passive -d $1 -o domains_$1
assetfinder --subs-only $1 | tee -a domains_41subfinder -d $1 -o domains_subfinder_$1
cat domains_subfinder_$1 | tee -a domains_$1sort -u domains_$1 -o domains_$1
cat domains_$1 | filter-resolved | tee -a domains_$1.txt

# Good subdomain finder script + XSS Checker
#!/bin/bash
# $1 => example.domainamass 
enum --passive -d $1 -o domains_$1
assetfinder --subs-only $1 | tee -a domains_41subfinder -d $1 -o domains_subfinder_$1
cat domains_subfinder_$1 | tee -a domains_$1sort -u domains_$1 -o domains_$1
cat domains_$1 | filter-resolved | tee -a domains_$1.txt
cat domains_$1.txt | ~/go/bin/httprobe -p http:81 -p http:8080 -p https:8443 | waybackurls | kxss | tee xss.txt
```

## Subdomain Takeover

```text
Explanation:
1. Domain name (sub.example.com) uses a CNAME record for another domain (sub.example.com CNAME anotherdomain.com).
2. At some point, anotherdomain.com expires and is available for anyone's registration.
3. Since the CNAME record is not removed from the DNS zone of example.com, anyone who records anotherdomain.com has full control over sub.example.com until the DNS record is present.

Best resources:
https://0xpatrik.com/takeover-proofs/
https://github.com/EdOverflow/can-i-take-over-xyz
https://blog.initd.sh/others-attacks/mis-configuration/subdomain-takeover-explained/

# Subzy
https://github.com/LukaSikic/subzy
subzy -targets list.txt
subzy -concurrency 100 -hide_fails -targets subs.txt

# SubOver
# https://github.com/Ice3man543/SubOver
SubOver -l /root/subdomains.txt -t 100 # Subdomains generated with subgen

# autoSubTakeover
https://github.com/JordyZomer/autoSubTakeover
pip install autosubtakeover
autosubtakeover --wordlist domains.txt

# subjack
https://github.com/haccer/subjack
subjack -w /root/subdomain.txt -a -v -t 100 -timeout 30 -o results.txt -ssl # Subdomains generated with subgen

# subdomain-takeover
# https://github.com/antichown/subdomain-takeover
python takeover.py -d domain.com -w /root/Repos/SecLists/Discovery/DNS/clean-jhaddix-dns.txt -t 100

# subgen (subdomain list generator)
# https://github.com/pry0cc/subgen
go get -u github.com/pry0cc/subgen
cat wordlist.txt | subgen -d "uber.com"
cat /home/user/Escritorio/tools/SecLists/Discovery/DNS/clean-jhaddix-dns.txt | subgen -d domain.com |  massdns -r /usr/share/wordlists/dns.txt -t A -o S -w results.txt
Check for results.txt
```

